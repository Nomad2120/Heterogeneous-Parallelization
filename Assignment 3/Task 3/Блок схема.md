```mermaid 
flowchart TD
    A([старт]) --> B{N > 0}
    B -- нет --> Z1[вывод N неверный] --> Z2([конец])
    B -- да --> C[задать N block stride iters]
    C --> D[создать массив h и заполнить]
    D --> E[выделить память gpu in out]
    E --> F{cuda ok}
    F -- нет --> X1[вывод ошибка cuda] --> X2([конец])
    F -- да --> G[скопировать h в in]
    G --> H{cuda ok}
    H -- нет --> X1

    H -- да --> I[прогрев coal]
    I --> J[замер coal iters]
    J --> K{kernel ok}
    K -- нет --> X1

    K -- да --> L[прогрев noncoal]
    L --> M[замер noncoal iters]
    M --> N{kernel ok}
    N -- нет --> X1

    N -- да --> O{coal быстрее}
    O -- да --> P[вывод coal быстрее]
    O -- нет --> Q[вывод noncoal быстрее или равно]
    P --> R[вывести времена]
    Q --> R
    R --> S[освободить память]
    S --> T([конец])

    subgraph COAL["GPU coal"]
        C1[tid = global id] --> C2{tid < N}
        C2 -- да --> C3[x = in tid]
        C3 --> C4[out tid = x * 2]
        C2 -- нет --> C5[ничего]
    end

    subgraph NONC["GPU noncoal"]
        N1[tid = global id] --> N2{tid < N}
        N2 -- да --> N3[idx = tid * stride mod N]
        N3 --> N4[x = in idx]
        N4 --> N5[out tid = x * 2]
        N2 -- нет --> N6[ничего]
    end
